<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/lfg+favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/lfg+favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/lfg+favicon.png">

  <!-- OpenGraph -->
  <meta property="og:title" content="Dirty Dashboard - Areas Failing to Manage Fly-Tipping">
  <meta property="og:description" content="Interactive map and league table tracking the worst areas in the UK for Fly-Tipping">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Looking For Growth">
  <meta property="og:image" content="https://dashboards.lookingforgrowth.uk/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Dirty Dashboard - Areas Failing to Manage Fly-Tipping">
  <meta name="twitter:description" content="Interactive map and league table tracking the worst areas in the UK for Fly-Tipping">
  <meta name="twitter:image" content="https://dashboards.lookingforgrowth.uk/og-image.png">

  <title>Dirty Dashboard | Looking For Growth</title>

  <!-- Google Fonts: DM Sans -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">

  <!-- Octarine font (LFG brand) -->
  <style>
    @font-face {
      font-family: 'Octarine';
      src: url('https://dashboards.lookingforgrowth.uk/_astro/Octarine-Bold.CR4U0q0x.otf') format('opentype');
      font-weight: 700;
      font-style: normal;
    }
    @font-face {
      font-family: 'Octarine';
      src: url('https://dashboards.lookingforgrowth.uk/_astro/Octarine-Light.uRTgbM2i.otf') format('opentype');
      font-weight: 300;
      font-style: normal;
    }
  </style>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <!-- MapLibre GL -->
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css">
  <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --brand-ocean-blue: #79CAC4;
      --brand-milky-white: #F5F0E8;
      --brand-flashy-orange: #FE5500;
      --brand-grassy-green: #4CB05A;
      --brand-royal-purple: #9B59B6;
      --brand-footer: #283848;
    }

    body {
      font-family: 'DM Sans', sans-serif;
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      color: #1a1a1a;
      -webkit-font-smoothing: antialiased;
    }

    .font-octarine { font-family: 'Octarine', sans-serif; }
    .font-dm-sans { font-family: 'DM Sans', sans-serif; }

    /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
    .nav-bar {
      position: sticky; top: 0; z-index: 50;
      background: var(--brand-ocean-blue);
      border-bottom: 3px solid #000;
      display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between;
      padding: 1rem; min-height: 80px;
      box-shadow: 0 1px 3px rgba(0,0,0,.1);
    }
    .nav-logo { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 2.25rem; color: #000; text-decoration: none; padding-top: .25rem; }
    .nav-links { display: flex; flex-wrap: wrap; align-items: center; gap: .5rem; }
    .nav-links > a { font-weight: 700; font-size: .875rem; padding: .5rem 1rem; border-radius: .5rem; text-decoration: none; color: #000; }
    .nav-links > a:hover { background: rgba(0,0,0,.08); }
    .nav-links .donate-btn {
      background: #FBBF24; border-radius: 9999px; color: #000; font-weight: 700;
      padding: .5rem 1rem; transition: background .3s;
    }
    .nav-links .donate-btn:hover { background: #F59E0B; }
    @media (max-width: 1023px) {
      .nav-links > a { display: none; }
    }
    @media (min-width: 1024px) {
      .nav-links-list { display: none; }
    }

    /* Mobile nav */
    .nav-hamburger { display: none; background: none; border: none; cursor: pointer; z-index: 60; }
    .nav-close { display: none; }
    .nav-mobile-header { display: none; }
    .nav-mobile-footer { display: none; }
    @media (max-width: 1023px) {
      .nav-hamburger { display: block; position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); }
      .nav-links {
        position: fixed; top: 0; left: 0; width: 100%; height: 100dvh;
        background: #fff; z-index: 100;
        display: flex; flex-direction: column; align-items: stretch;
        transform: translateX(100%);
        transition: transform .35s ease;
      }
      .nav-links.open { transform: translateX(0); }
      .nav-mobile-header {
        display: flex; align-items: center; justify-content: center;
        background: var(--brand-ocean-blue); padding: 1rem 1.5rem; min-height: 70px;
        position: relative; flex-shrink: 0;
      }
      .nav-mobile-header .nav-mobile-logo {
        font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 1.75rem; color: #000; text-decoration: none;
      }
      .nav-close {
        display: block; position: absolute; right: 1.25rem; top: 50%; transform: translateY(-50%);
        background: none; border: none; cursor: pointer; z-index: 101; padding: .25rem;
      }
      .nav-links-list {
        flex: 1; display: flex; flex-direction: column; align-items: flex-start;
        padding: 1.5rem 1.5rem 1rem; gap: 0; overflow-y: auto;
      }
      .nav-links-list a {
        font-weight: 700; font-size: 1.2rem; padding: .85rem 0; width: 100%;
        text-decoration: none; color: #000; border-radius: 0;
      }
      .nav-links-list a:hover { background: none; opacity: .7; }
      .nav-links .donate-btn { display: none; }
      .nav-mobile-footer {
        display: flex; flex-direction: column; gap: 1rem;
        background: #f3f4f6; padding: 1.5rem; border-top: 1px solid #e5e7eb; flex-shrink: 0;
      }
      .nav-mobile-footer a {
        font-weight: 700; font-size: 1.1rem; color: #000; text-decoration: underline;
        text-underline-offset: 3px;
      }
      .nav-overlay { display: none; }
    }

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero {
      background: var(--brand-milky-white);
      border-bottom: 2px solid #000;
      display: flex; align-items: center; justify-content: center;
      padding: 3rem 1.5rem; min-height: 40vh;
    }
    .hero h1 { text-align: center; font-family: 'Octarine', sans-serif; font-weight: 800; font-size: 2rem; text-transform: uppercase; }
    @media (min-width: 768px) { .hero h1 { font-size: 3rem; } }

    /* ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ */
    .section { max-width: 64rem; width: 100%; margin: 0 auto; padding: 2rem 2rem; }
    .section.wide { max-width: 72rem; }
    .section-intro { display: flex; flex-direction: column; gap: 2.5rem; text-align: center; margin-top: 2.5rem; padding-bottom: 4rem; }
    .section-intro h2 { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 2rem; }
    @media (min-width: 768px) { .section-intro h2 { font-size: 2.25rem; } }
    .section-intro .desc { display: flex; flex-direction: column; gap: 2rem; font-size: 1.125rem; font-weight: 300; line-height: 1.7; }
    @media (min-width: 768px) { .section-intro .desc { font-size: 1.5rem; } }

    /* ‚îÄ‚îÄ NEWSLETTER FORM ‚îÄ‚îÄ */
    .newsletter-form {
      background: #fff; border-radius: .75rem; padding: 2rem; display: flex; flex-direction: column; gap: 1.25rem;
      box-shadow: 0 10px 25px rgba(0,0,0,.1); border: 2px solid #000; max-width: 28rem; width: 100%; margin: 0 auto;
    }
    .newsletter-form label { font-size: .875rem; font-weight: 500; }
    .newsletter-form input[type="text"],
    .newsletter-form input[type="email"] {
      width: 100%; height: 3rem; border: 2px solid #000; border-radius: .75rem;
      padding: .5rem .75rem; font-size: 1rem; outline: none; transition: border-color .2s, box-shadow .2s;
      background: #EBE3D0;
    }
    .newsletter-form input:focus { border-color: var(--brand-ocean-blue); box-shadow: 0 0 0 3px rgba(121,202,196,.3); }
    .newsletter-form button {
      background: #000; color: #fff; font-weight: 700; padding: .625rem 1.5rem; border-radius: 8px; border: none; cursor: pointer;
      border-top: 2px solid var(--brand-flashy-orange);
      border-bottom: 6px solid var(--brand-flashy-orange);
      border-left: 2px solid var(--brand-flashy-orange);
      border-right: 6px solid var(--brand-flashy-orange);
      transition: all .2s;
    }
    .newsletter-form button:hover { background: var(--brand-flashy-orange); color: #000; border-color: #000; }

    /* ‚îÄ‚îÄ LEAGUE TABLE ‚îÄ‚îÄ */
    .league-table-wrapper {
      background: #fff; border-radius: .75rem; border: 2px solid #000;
      box-shadow: 0 10px 25px rgba(0,0,0,.1); overflow-x: auto; -webkit-overflow-scrolling: touch;
    }
    .table-header {
      background: var(--brand-ocean-blue); color: #fff; font-family: 'Octarine', sans-serif; font-weight: 700;
      display: grid; grid-template-columns: 1fr 5fr 3fr; gap: 1rem; padding: 1rem;
      font-size: .875rem; min-width: 400px;
    }
    @media (min-width: 768px) {
      .table-header { grid-template-columns: 1fr 5fr 2fr 3fr; font-size: 1rem; }
    }
    .table-header > div { display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: .25rem; padding: .25rem .5rem; text-align: center; }
    .table-header > div:hover { background: rgba(255,255,255,.15); }
    .table-header .col-name { justify-content: flex-start; }
    .table-header .col-total { display: none; }
    @media (min-width: 768px) { .table-header .col-total { display: flex; } }

    .table-row {
      display: grid; grid-template-columns: 1fr 5fr 3fr; gap: 1rem; padding: 1rem;
      border-bottom: 1px solid #e5e7eb; transition: background .2s; min-width: 400px;
    }
    @media (min-width: 768px) {
      .table-row { grid-template-columns: 1fr 5fr 2fr 3fr; }
    }
    .table-row:hover { background: #f9fafb; }
    .table-row > div { display: flex; align-items: center; justify-content: center; text-align: center; }
    .table-row .col-name { justify-content: flex-start; }
    .table-row .col-total { display: none; }
    @media (min-width: 768px) { .table-row .col-total { display: flex; } }

    .table-row .rank { font-weight: 700; }
    .table-row .authority-name { font-weight: 600; color: #111827; }
    .table-row .authority-code { font-size: .75rem; color: #6b7280; }
    .table-row .stat-value { font-weight: 700; }
    .table-row .stat-label { font-size: .625rem; color: #6b7280; }
    @media (min-width: 768px) { .table-row .stat-label { font-size: .75rem; } }

    .table-footer { background: #f9fafb; padding: 1rem; text-align: center; font-size: .875rem; color: #4b5563; border-top: 1px solid #e5e7eb; min-width: 500px; }
    .table-footer button {
      margin-top: .5rem; padding: .5rem 1rem; background: var(--brand-ocean-blue); color: #fff;
      border: none; border-radius: .5rem; cursor: pointer; font-family: 'DM Sans', sans-serif; font-weight: 600;
      transition: opacity .2s;
    }
    .table-footer button:hover { opacity: .9; }

    /* ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ */
    .search-input {
      width: 100%; padding: .75rem 1rem; border: 2px solid #d1d5db; border-radius: .5rem;
      font-family: 'DM Sans', sans-serif; font-size: 1rem; outline: none; transition: border-color .2s;
      margin-bottom: 1rem;
    }
    .search-input:focus { border-color: var(--brand-ocean-blue); }

    /* ‚îÄ‚îÄ SEARCH PREVIEW ‚îÄ‚îÄ */
    .search-preview {
      display: flex; flex-direction: column; gap: .5rem;
    }
    .search-preview-item {
      background: #fff; border: 2px solid #e5e7eb; border-radius: .75rem;
      padding: 1rem 1.25rem; display: flex; justify-content: space-between; align-items: center;
      cursor: pointer; transition: border-color .2s, box-shadow .2s;
    }
    .search-preview-item:hover { border-color: var(--brand-ocean-blue); box-shadow: 0 2px 8px rgba(0,0,0,.08); }
    .search-preview-name { font-weight: 700; color: #111827; }
    .search-preview-stat { font-weight: 700; font-size: .875rem; }
    .search-preview-label { font-size: .75rem; color: #6b7280; }

    /* ‚îÄ‚îÄ TABLE TOGGLE ‚îÄ‚îÄ */
    .table-toggle-btn {
      display: flex; align-items: center; justify-content: center; gap: .5rem;
      margin: 0 auto; padding: .625rem 1.5rem;
      background: var(--brand-ocean-blue); color: #fff; border: 2px solid #000;
      border-radius: .5rem; font-family: 'Octarine', sans-serif; font-weight: 700;
      font-size: .9rem; cursor: pointer; transition: opacity .2s;
    }
    .table-toggle-btn:hover { opacity: .9; }
    .table-toggle-btn.open svg { transform: rotate(180deg); }
    .table-toggle-btn svg { transition: transform .25s ease; }

    /* ‚îÄ‚îÄ STATS CARDS ‚îÄ‚îÄ */
    .stats-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; margin-top: 1.5rem; max-width: 900px; margin-left: auto; margin-right: auto; }
    @media (min-width: 768px) { .stats-grid { grid-template-columns: repeat(3, 1fr); } }
    .stat-card {
      background: #fff; padding: 1rem 1.5rem; border-radius: .5rem; border: 2px solid #000;
      box-shadow: 0 4px 10px rgba(0,0,0,.1); text-align: center; min-height: 6rem;
      display: flex; flex-direction: column; justify-content: center;
    }
    .stat-card .stat-big { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 1.25rem; }
    @media (min-width: 1024px) { .stat-card .stat-big { font-size: 1.5rem; } }
    .stat-card .stat-desc { font-size: .875rem; color: #4b5563; }

    /* ‚îÄ‚îÄ METHODOLOGY NOTE ‚îÄ‚îÄ */
    .methodology {
      margin-top: 1.5rem; background: #f9fafb; padding: 1.5rem; border-radius: .5rem;
      border: 1px solid #e5e7eb; font-size: .875rem; color: #374151; line-height: 1.7;
    }
    .methodology p { margin-bottom: .75rem; }
    .methodology p:last-child { margin-bottom: 0; }
    .methodology a { color: #2563eb; text-decoration: underline; }
    .methodology a:hover { color: #1e40af; }

    /* ‚îÄ‚îÄ MAP ‚îÄ‚îÄ */
    .map-section { text-align: center; }
    .map-section h2 { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 1.5rem; margin-bottom: .5rem; }
    @media (min-width: 768px) { .map-section h2 { font-size: 2rem; } }
    .map-section .subtitle { font-size: 1.125rem; margin-bottom: .5rem; }
    .map-section .click-hint { font-weight: 700; font-size: .875rem; }
    @media (min-width: 768px) { .map-section .click-hint { font-size: 1rem; } }
    #map-container { width: 100%; min-height: 500px; border-radius: 16px; overflow: hidden; border: 3px solid #000; margin-top: 1rem; position: relative; background: #79CAC4; }
    .map-placeholder {
      display: flex; align-items: center; justify-content: center; min-height: 500px;
      background: #f1f5f9; color: #64748b; font-size: 1.125rem; font-weight: 500;
    }
    #map { width: 100%; height: 600px; }
    .map-popup { font-family: 'DM Sans', sans-serif; padding: .25rem; }
    .map-popup h4 { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 1rem; margin-bottom: .25rem; }
    .map-popup .code { font-size: .75rem; color: #6b7280; }
    .map-popup .stats { margin-top: .5rem; font-size: .875rem; }
    .map-popup .stats div { margin-bottom: .25rem; }
    .map-legend {
      position: absolute; bottom: 2rem; right: 1rem; background: rgba(255,255,255,.95);
      padding: .75rem 1rem; border-radius: .5rem; font-size: .75rem; z-index: 5;
      box-shadow: 0 2px 8px rgba(0,0,0,.15); border: 1px solid #e5e7eb;
    }
    .map-legend h4 { font-weight: 700; margin-bottom: .5rem; font-size: .8rem; }
    .map-legend .legend-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    .map-legend .legend-swatch { width: 16px; height: 16px; border-radius: 2px; border: 1px solid #ccc; }

    /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
    .site-footer {
      background: var(--brand-footer); color: #fff; padding: 3rem 1.5rem; margin-top: auto;
    }
    .footer-grid {
      display: grid; grid-template-columns: 1fr; gap: 2rem; text-align: center; align-items: center;
    }
    @media (min-width: 768px) {
      .footer-grid { grid-template-columns: repeat(3, 1fr); text-align: left; }
      .footer-center { text-align: center; }
      .footer-right { display: flex; gap: 1rem; justify-content: flex-end; }
    }
    .footer-social { display: flex; justify-content: center; gap: 1rem; margin-top: 1rem; }
    .footer-social a { color: #fff; transition: color .2s; text-decoration: none; }
    .footer-social a:hover { color: #d1d5db; }
    .footer-right a { color: #fff; text-decoration: underline; }

    /* ‚îÄ‚îÄ SIGNUP MODAL ‚îÄ‚îÄ */
    .signup-modal-overlay {
      position: fixed; inset: 0; z-index: 10000;
      background: rgba(0,0,0,.5); display: none; align-items: center; justify-content: center;
      padding: 1rem;
    }
    .signup-modal-overlay.show { display: flex; }
    .signup-modal {
      background: #fff; border: 3px solid #000;
      padding: 2.5rem 2rem; max-width: 500px; width: 90%; text-align: center;
      box-shadow: 8px 8px 0 #000; position: relative;
    }
    .signup-modal-x {
      position: absolute; top: .75rem; right: .75rem; background: none; border: none;
      cursor: pointer; font-size: 1.5rem; line-height: 1; padding: .25rem; color: #000;
    }
    .signup-modal-x:hover { opacity: .6; }
    .signup-modal h3 { font-family: 'Octarine', sans-serif; font-weight: 700; font-size: 1.5rem; margin-bottom: .5rem; }
    .signup-modal p { color: #4b5563; font-size: .95rem; margin-bottom: 1.5rem; }
    .signup-modal-socials { display: flex; flex-direction: column; gap: .625rem; margin-bottom: 1.5rem; }
    .signup-modal-socials a {
      display: flex; align-items: center; justify-content: center; gap: .5rem;
      padding: .75rem 1.25rem; font-weight: 700; font-size: .95rem;
      text-decoration: none; color: #fff; border: 2px solid #000; transition: opacity .2s;
    }
    .signup-modal-socials a:hover { opacity: .85; }
    .signup-modal-socials .btn-x { background: #000; }
    .signup-modal-socials .btn-ig { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
    .signup-modal-close {
      background: none; border: 2px solid #000;
      padding: .6rem 1.5rem; cursor: pointer; font-family: 'DM Sans', sans-serif;
      font-weight: 700; font-size: .875rem; color: #000; transition: background .2s;
    }
    .signup-modal-close:hover { background: #f3f4f6; }

    /* ‚îÄ‚îÄ SORT ARROWS ‚îÄ‚îÄ */
    .sort-icon { width: 16px; height: 16px; margin-left: 4px; flex-shrink: 0; }

    /* ‚îÄ‚îÄ LOADING SKELETON ‚îÄ‚îÄ */
    .skeleton-row { animation: pulse 1.5s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .4; } }

    /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
    .empty-state {
      padding: 4rem 2rem; text-align: center; color: #6b7280;
    }
    .empty-state .icon { font-size: 3rem; margin-bottom: 1rem; }
    .empty-state h3 { font-family: 'Octarine', sans-serif; font-size: 1.5rem; font-weight: 700; color: #374151; margin-bottom: .5rem; }
    .empty-state p { font-size: 1rem; }
  </style>
</head>
<body>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NAV ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <nav class="nav-bar">
    <a href="https://lookingforgrowth.uk" class="nav-logo">LFG</a>
    <button class="nav-hamburger" onclick="toggleNav()" aria-label="Menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
    <div class="nav-links">
      <!-- Mobile header with LFG logo + close button -->
      <div class="nav-mobile-header">
        <a href="https://lookingforgrowth.uk" class="nav-mobile-logo">LFG</a>
        <button class="nav-close" onclick="toggleNav()" aria-label="Close menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <!-- Nav links -->
      <div class="nav-links-list">
        <a href="https://lookingforgrowth.uk/youth-unemployment-dashboard.html">Youth Unemployment</a>
        <a href="https://dashboards.lookingforgrowth.uk/dashboards/opinion-tracker">Opinion Tracker</a>
        <a href="https://dashboards.lookingforgrowth.uk/dashboards/energy-costs/">Energy Costs</a>
        <a href="https://dashboards.lookingforgrowth.uk/dashboards/state-of-the-nation">State of the Nation</a>
        <a href="https://dashboards.lookingforgrowth.uk/dashboards/no-more-delays/">No More Delays</a>
        <a href="https://dashboards.lookingforgrowth.uk/dashboards/planning-applications/admin-ongoing/">Planning Applications</a>
        <a href="#">Dirty Dashboard</a>
      </div>
      <!-- Mobile footer with donate + merch -->
      <div class="nav-mobile-footer">
        <a href="https://lookingforgrowth.uk/donate">donate &rarr;</a>
        <a href="https://merch.lookingforgrowth.uk/" target="_blank" rel="noopener noreferrer">buy our merch &rarr;</a>
      </div>
      <!-- Desktop-only links (hidden on mobile) -->
      <a href="https://dashboards.lookingforgrowth.uk/">Other Dashboards</a>
      <a href="https://merch.lookingforgrowth.uk/" target="_blank" rel="noopener noreferrer">Merch</a>
      <a href="https://lookingforgrowth.uk/donate" class="donate-btn">donate</a>
    </div>
  </nav>
  <div class="nav-overlay" onclick="toggleNav()"></div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="hero">
    <h1>The Dirty Dashboard</h1>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INTRO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section section-intro">
    <h2 class="font-octarine">UK streets are plagued with RAMPANT FLY TIPPING which never gets resolved</h2>
    <div class="desc">
      <p>local authorities are responsible for investigating fly-tipping</p>
      <p>but many areas have 10,000s of cases and solution rates close to 0%</p>
      <p>it doesn't have to be this way, and local authorities should be made to ACT</p>
    </div>

  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LEAGUE TABLE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <div style="display:flex;flex-direction:column;gap:2.5rem;">
      <h2 class="font-octarine" style="font-weight:700;font-size:2rem;text-align:center;">fly-tipping league table</h2>
      <!-- Search -->
      <input type="text" class="search-input" id="search-input" placeholder="Search for your local authority..." oninput="handleSearch(this.value)">

      <!-- Search Preview (shown when searching and table collapsed) -->
      <div id="search-preview" class="search-preview" style="display:none;"></div>

      <!-- Toggle Button -->
      <button class="table-toggle-btn" id="table-toggle-btn" onclick="toggleTable()">
        <span id="toggle-label">View full table</span>
        <svg id="toggle-chevron" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
      </button>

      <!-- Table (collapsed by default) -->
      <div class="league-table-wrapper" id="table-wrapper" style="display:none;">
        <div class="table-header" id="table-header">
          <div onclick="sortTable('rank')">#</div>
          <div class="col-name" onclick="sortTable('authority')"><span>Local Authority</span><span class="sort-icon" id="sort-authority"></span></div>
          <div class="col-total" onclick="sortTable('totalCases')"><span>Total Cases</span><span class="sort-icon" id="sort-totalCases"></span></div>
          <div onclick="sortTable('fpnToIncidents')"><span>% of FPNs<br>to Incidents</span><span class="sort-icon" id="sort-fpnToIncidents"></span></div>
        </div>
        <div id="table-body">
          <!-- Rows rendered by JS -->
          <div class="empty-state">
            <div class="icon">üìä</div>
            <h3>Data Loading Soon</h3>
            <p>New data will be available when the spreadsheet is connected.<br>Check back at 9:30 AM on release day.</p>
          </div>
        </div>
        <div class="table-footer" id="table-footer" style="display:none;">
          <p>Click column headers to sort &bull; Showing top <span id="showing-count">20</span> local authorities</p>
          <button onclick="showMore()">Show next 20</button>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="stats-grid" id="stats-grid">
        <div class="stat-card">
          <div class="stat-big" style="color:#ea580c;" id="stat-avg-fpn">‚Äî</div>
          <div class="stat-desc">Avg % of FPNs to Incidents</div>
        </div>
        <div class="stat-card">
          <div class="stat-big" style="color:#7f1d1d;" id="stat-worst-council">‚Äî</div>
          <div class="stat-desc">Worst Council</div>
          <div style="font-size:.75rem;color:#6b7280;margin-top:.25rem;" id="stat-worst-council-rate"></div>
        </div>
        <div class="stat-card">
          <div class="stat-big" style="color:#dc2626;" id="stat-most-incidents">‚Äî</div>
          <div class="stat-desc">Most Incidents</div>
          <div style="font-size:.75rem;color:#6b7280;margin-top:.25rem;" id="stat-most-incidents-count"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" style="padding-top:1rem;padding-bottom:2.5rem;">
    <div class="map-section">
      <h2>fly-tipping map</h2>
      <p class="subtitle">explore fly-tipping rates across England's local authorities</p>
      <p class="click-hint">click regions for more information</p>
      <div id="map-container">
        <div id="map"></div>
        <div class="map-legend">
          <h4>% of FPNs to Incidents</h4>
          <div class="legend-item"><div class="legend-swatch" style="background:#7f1d1d"></div> 0-5% Disgraceful</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#dc2626"></div> 5-10% Very Poor</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#f97316"></div> 10-20% Poor</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#eab308"></div> 20-40% Decent</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#16a34a"></div> 40-100% Acceptable</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#9B59B6"></div> 100%+ Suspicious</div>
          <div class="legend-item"><div class="legend-swatch" style="background:#EBE3D0"></div> No data</div>
        </div>
      </div>
      <div class="methodology" style="margin-top:1.5rem;">
        <p>A Fixed Penalty Notice is a mechanism from the Government to allow someone to avoid prosecution and discharge their liability through paying a fine.</p>
        <p>Anything highlighted in purple is a suspicious value (over 100%). This could be due to several factors, such as multiple offenders being involved in a single fly-tipping incident, or reporting issues.</p>
        <p>The 'Worst Council' is the local authority with the lowest ratio of Fixed Penalty Notices issued to fly-tipping incidents reported. This measures how poorly a council is using its enforcement powers relative to the scale of the problem in its area.</p>
        <p><strong>Source:</strong> <a href="https://www.gov.uk/government/statistics/announcements/fly-tipping-statistics-for-england--3" target="_blank" rel="noopener noreferrer">Fly-tipping statistics for England ‚Äî GOV.UK</a></p>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEWSLETTER CTA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div style="background:#EBE3D0;padding:3rem 1.5rem;border-top:3px solid #000;border-bottom:3px solid #000;">
    <div style="max-width:700px;margin:0 auto;text-align:center;display:flex;flex-direction:column;gap:1rem;align-items:center;">
      <h2 class="font-octarine" style="font-weight:700;font-size:2rem;">Think this isn't on?</h2>
      <p style="font-size:1.125rem;font-weight:300;line-height:1.7;">Join our mailing list and reverse Britain's decline.</p>
      <form class="newsletter-form" id="newsletter-form-1" onsubmit="return handleNewsletter(event, this)" style="background:transparent;box-shadow:none;border:none;max-width:100%;width:100%;">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
          <div style="display:flex;flex-direction:column;gap:.5rem;text-align:left;">
            <label>name</label>
            <input type="text" name="firstName" style="border:2px solid #000;border-radius:.75rem;background:#EBE3D0;">
          </div>
          <div style="display:flex;flex-direction:column;gap:.5rem;text-align:left;">
            <label>email*</label>
            <input type="email" name="email" required style="border:2px solid #000;border-radius:.75rem;background:#EBE3D0;">
          </div>
        </div>
        <button type="submit">join us</button>
      </form>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOOTER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <footer class="site-footer">
    <div class="footer-grid" style="max-width:72rem;margin:0 auto;">
      <div>
        <div>Something Completely Different Limited</div>
        <div>For enquiries and concerns</div>
        <div>hello@lookingforgrowth.uk</div>
      </div>
      <div class="footer-center">
        <div>For Press Enquiries</div>
        <div>press@lookingforgrowth.uk</div>
        <div class="footer-social">
          <a href="https://www.linkedin.com/company/lfg-uk" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/></svg>
          </a>
          <a href="https://www.tiktok.com/@looking.for.growth" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-2.88 2.5 2.89 2.89 0 01-2.89-2.89 2.89 2.89 0 012.89-2.89 2.84 2.84 0 01.89.14V9.02a6.25 6.25 0 00-1-.05A6.34 6.34 0 003 15.31a6.34 6.34 0 006.38 6.33 6.34 6.34 0 006.38-6.33V9.19a8.16 8.16 0 004.83 1.56V7.3a4.85 4.85 0 01-1-.61z"/></svg>
          </a>
          <a href="https://x.com/lfg_uk" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter)">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
          <a href="https://www.facebook.com/lookingforgrowth/" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
          </a>
          <a href="https://www.instagram.com/lookingforgrowthuk/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
          </a>
        </div>
      </div>
      <div class="footer-right" style="display:flex;flex-direction:column;gap:1rem;">
        <a download href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/Privacy+Policy.pdf">Privacy Policy</a>
        <a download href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/Cookies+Policy.pdf">Cookie Policy</a>
      </div>
    </div>
  </footer>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JAVASCRIPT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <script>
    // ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    // MOBILE NAV TOGGLE
    function toggleNav() {
      document.querySelector('.nav-links').classList.toggle('open');
      document.querySelector('.nav-overlay').classList.toggle('open');
    }

    // ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    // DATA SOURCE
    // Replace this empty array with your spreadsheet data.
    // Each object should have these fields:
    //   authority, code, totalCases,
    //   penaltyRate, fpnToIncidents
    //
    // Example:
    //   { authority: "Croydon", code: "E09000008", totalCases: 35470,
    //     unresolvedCases: 35462, penaltyRate: 0.0, prosecutionRate: 0.0 }
    //
    // To connect to a Google Sheet:
    //   1. Publish the sheet as CSV
    //   2. Fetch & parse it in loadSpreadsheetData() below
    // ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

    let ALL_DATA = [];

    // ‚îÄ‚îÄ Spreadsheet loader (update URL when ready) ‚îÄ‚îÄ
    const SPREADSHEET_CSV_URL = ''; // e.g. 'https://docs.google.com/spreadsheets/d/XXXXX/export?format=csv'

    async function loadSpreadsheetData() {
      if (!SPREADSHEET_CSV_URL) return;
      try {
        const res = await fetch(SPREADSHEET_CSV_URL);
        const text = await res.text();
        const rows = text.trim().split('\n').map(r => r.split(','));
        const headers = rows[0];
        ALL_DATA = rows.slice(1).map(row => {
          const obj = {};
          headers.forEach((h, i) => { obj[h.trim()] = row[i] ? row[i].trim() : ''; });
          return {
            authority: obj['authority'] || obj['Local Authority'] || obj['la_name'] || '',
            code: obj['code'] || obj['la_code'] || obj['ONS Code'] || '',
            totalCases: parseFloat(obj['totalCases'] || obj['total_cases'] || obj['Total Incidents'] || 0),
            penaltyRate: parseFloat(obj['penaltyRate'] || obj['penalty_rate'] || obj['FPN Rate'] || 0),
            fpnToIncidents: parseFloat(obj['fpnToIncidents'] || obj['fpn_to_incidents'] || obj['% FPNs to Incidents'] || 0),
          };
        }).filter(d => d.authority);
        initDashboard();
      } catch (e) {
        console.error('Failed to load spreadsheet:', e);
      }
    }

    // ‚îÄ‚îÄ State ‚îÄ‚îÄ
    let currentSort = { key: 'totalCases', dir: 'desc' };
    let pageSize = 20;
    let currentPage = 1;
    let searchTerm = '';

    // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ
    function formatNumber(n) {
      return n.toLocaleString('en-GB');
    }

    function getRating(value) {
      if (value > 100) return { label: 'Suspicious', color: '#9B59B6' };
      if (value <= 5) return { label: 'Disgraceful', color: '#7f1d1d' };
      if (value <= 10) return { label: 'Very Poor', color: '#dc2626' };
      if (value <= 20) return { label: 'Poor', color: '#f97316' };
      if (value <= 40) return { label: 'Decent', color: '#eab308' };
      return { label: 'Acceptable', color: '#16a34a' };
    }

    // ‚îÄ‚îÄ Sort ‚îÄ‚îÄ
    function sortTable(key) {
      if (currentSort.key === key) {
        currentSort.dir = currentSort.dir === 'desc' ? 'asc' : 'desc';
      } else {
        currentSort = { key, dir: key === 'authority' ? 'asc' : 'desc' };
      }
      currentPage = 1;
      renderTable();
    }

    function getSortedData() {
      let data = [...ALL_DATA];
      if (searchTerm) {
        const q = searchTerm.toLowerCase();
        data = data.filter(d => d.authority.toLowerCase().includes(q) || d.code.toLowerCase().includes(q));
      }
      const { key, dir } = currentSort;
      data.sort((a, b) => {
        let va = a[key], vb = b[key];
        if (typeof va === 'string') { va = va.toLowerCase(); vb = vb.toLowerCase(); }
        if (va < vb) return dir === 'asc' ? -1 : 1;
        if (va > vb) return dir === 'asc' ? 1 : -1;
        return 0;
      });
      // Add rank
      data.forEach((d, i) => { d.rank = i + 1; });
      return data;
    }

    // ‚îÄ‚îÄ Render ‚îÄ‚îÄ
    function renderTable() {
      const body = document.getElementById('table-body');
      const footer = document.getElementById('table-footer');
      const sorted = getSortedData();
      const visible = sorted.slice(0, currentPage * pageSize);

      if (ALL_DATA.length === 0) {
        body.innerHTML = `
          <div class="empty-state">
            <div class="icon">üìä</div>
            <h3>Data Loading Soon</h3>
            <p>New data will be available when the spreadsheet is connected.<br>Check back at 9:30 AM on release day.</p>
          </div>`;
        footer.style.display = 'none';
        return;
      }

      if (sorted.length === 0) {
        body.innerHTML = `
          <div class="empty-state">
            <div class="icon">üîç</div>
            <h3>No results found</h3>
            <p>Try a different search term</p>
          </div>`;
        footer.style.display = 'none';
        return;
      }

      let html = '';
      visible.forEach(d => {
        const fpnRating = getRating(d.fpnToIncidents);

        html += `
          <div class="table-row">
            <div class="rank">${d.rank}</div>
            <div class="col-name">
              <div>
                <div class="authority-name">${d.authority}</div>
              </div>
            </div>
            <div class="col-total">
              <div>
                <div class="stat-value">${formatNumber(d.totalCases)}</div>
                <div class="stat-label">total</div>
              </div>
            </div>
            <div>
              <div>
                <div class="stat-value" style="color:${fpnRating.color}">${d.fpnToIncidents.toFixed(1)}%</div>
                <div class="stat-label">${fpnRating.label}</div>
              </div>
            </div>
          </div>`;
      });

      body.innerHTML = html;

      document.getElementById('showing-count').textContent = Math.min(visible.length, sorted.length);
      footer.style.display = visible.length < sorted.length ? 'block' : 'block';
      footer.querySelector('button').style.display = visible.length < sorted.length ? 'inline-block' : 'none';

      // Update sort arrows
      ['authority','totalCases','fpnToIncidents'].forEach(k => {
        const el = document.getElementById('sort-' + k);
        if (el) {
          if (currentSort.key === k) {
            el.innerHTML = currentSort.dir === 'desc' ? '&#9660;' : '&#9650;';
          } else {
            el.innerHTML = '';
          }
        }
      });
    }

    function showMore() {
      currentPage++;
      renderTable();
    }

    let tableExpanded = false;

    function toggleTable() {
      tableExpanded = !tableExpanded;
      const wrapper = document.getElementById('table-wrapper');
      const btn = document.getElementById('table-toggle-btn');
      const label = document.getElementById('toggle-label');
      const preview = document.getElementById('search-preview');
      wrapper.style.display = tableExpanded ? 'block' : 'none';
      btn.classList.toggle('open', tableExpanded);
      label.textContent = tableExpanded ? 'Hide table' : 'View full table';
      if (tableExpanded) { preview.style.display = 'none'; }
    }

    function renderSearchPreview() {
      const preview = document.getElementById('search-preview');
      if (!searchTerm || tableExpanded || ALL_DATA.length === 0) {
        preview.style.display = 'none';
        return;
      }
      const q = searchTerm.toLowerCase();
      const matches = ALL_DATA.filter(d => d.authority.toLowerCase().includes(q)).slice(0, 5);
      if (matches.length === 0) {
        preview.style.display = 'block';
        preview.innerHTML = '<div style="text-align:center;color:#6b7280;padding:1rem;">No matching local authorities found</div>';
        return;
      }
      preview.style.display = 'flex';
      preview.innerHTML = matches.map(d => {
        const rating = getRating(d.fpnToIncidents);
        return `<div class="search-preview-item" onclick="expandToResult('${d.authority.replace(/'/g, "\\'")}')">
          <div>
            <div class="search-preview-name">${d.authority}</div>
            <div class="search-preview-label">${formatNumber(d.totalCases)} total cases</div>
          </div>
          <div style="text-align:right;">
            <div class="search-preview-stat" style="color:${rating.color}">${d.fpnToIncidents.toFixed(1)}%</div>
            <div class="search-preview-label">FPNs to incidents</div>
          </div>
        </div>`;
      }).join('');
    }

    function expandToResult(name) {
      document.getElementById('search-input').value = name;
      searchTerm = name;
      currentPage = 1;
      tableExpanded = true;
      document.getElementById('table-wrapper').style.display = 'block';
      document.getElementById('table-toggle-btn').classList.add('open');
      document.getElementById('toggle-label').textContent = 'Hide table';
      document.getElementById('search-preview').style.display = 'none';
      renderTable();
    }

    function handleSearch(value) {
      searchTerm = value;
      currentPage = 1;
      renderSearchPreview();
      if (tableExpanded) { renderTable(); }
    }

    // ‚îÄ‚îÄ Stats ‚îÄ‚îÄ
    function updateStats() {
      if (ALL_DATA.length === 0) return;
      const avgFpnToInc = ALL_DATA.reduce((s, d) => s + d.fpnToIncidents, 0) / ALL_DATA.length;
      document.getElementById('stat-avg-fpn').textContent = avgFpnToInc.toFixed(2) + '%';

      // Worst council = lowest FPN to incidents ratio
      const worst = ALL_DATA.reduce((min, d) => d.fpnToIncidents < min.fpnToIncidents ? d : min, ALL_DATA[0]);
      document.getElementById('stat-worst-council').textContent = worst.authority;
      document.getElementById('stat-worst-council-rate').textContent = worst.fpnToIncidents.toFixed(2) + '% FPNs to incidents';

      // Most incidents
      const most = ALL_DATA.reduce((max, d) => d.totalCases > max.totalCases ? d : max, ALL_DATA[0]);
      document.getElementById('stat-most-incidents').textContent = most.authority;
      document.getElementById('stat-most-incidents-count').textContent = formatNumber(most.totalCases) + ' incidents';

    }

    // ‚îÄ‚îÄ Newsletter (Brevo via Zapier) ‚îÄ‚îÄ
    function handleNewsletter(e, form) {
      e.preventDefault();
      const name = form.querySelector('input[name="firstName"]').value;
      const email = form.querySelector('input[name="email"]').value;

      const payload = new URLSearchParams({
        'Name': name,
        'Email': email,
        'List ID(s)': '119'
      });

      fetch('https://hooks.zapier.com/hooks/catch/24440311/ursog2a/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: payload.toString()
      })
      .then(res => {
        if (!res.ok) throw new Error('Failed');
        form.reset();
        document.getElementById('signup-modal').classList.add('show');
      })
      .catch(() => {
        alert('Something went wrong. Please try again.');
      });

      return false;
    }

    // ‚îÄ‚îÄ Map ‚îÄ‚îÄ
    let map = null;

    function initMap() {
      map = new maplibregl.Map({
        container: 'map',
        style: {
          version: 8,
          sources: {},
          layers: [{
            id: 'background',
            type: 'background',
            paint: { 'background-color': '#79CAC4' }
          }]
        },
        center: [-1.5, 52.8],
        zoom: 5.5,
        maxBounds: [[-12, 49], [5, 57]]
      });

      map.addControl(new maplibregl.NavigationControl(), 'top-left');

      map.on('load', () => {
        fetch('england-la.geojson')
          .then(r => r.json())
          .then(geojson => {
            // Attach data to features if available
            if (ALL_DATA.length > 0) {
              const dataMap = {};
              ALL_DATA.forEach(d => { dataMap[d.code] = d; });
              geojson.features.forEach(f => {
                const code = f.properties.LAD24CD;
                const d = dataMap[code];
                if (d) {
                  f.properties.totalCases = d.totalCases;
                  f.properties.fpnToIncidents = d.fpnToIncidents;
                  f.properties.solveRate = d.fpnToIncidents;
                  f.properties.hasData = true;
                } else {
                  f.properties.hasData = false;
                  f.properties.solveRate = -1;
                }
              });
            } else {
              geojson.features.forEach(f => {
                f.properties.hasData = false;
                f.properties.solveRate = -1;
              });
            }

            map.addSource('la-boundaries', { type: 'geojson', data: geojson });

            // Fill layer with color based on solve rate (cream when no data)
            map.addLayer({
              id: 'la-fill',
              type: 'fill',
              source: 'la-boundaries',
              paint: {
                'fill-color': [
                  'case',
                  ['==', ['get', 'hasData'], false], '#EBE3D0',
                  ['>', ['get', 'solveRate'], 100], '#9B59B6',
                  ['<', ['get', 'solveRate'], 5], '#7f1d1d',
                  ['<', ['get', 'solveRate'], 10], '#dc2626',
                  ['<', ['get', 'solveRate'], 20], '#f97316',
                  ['<', ['get', 'solveRate'], 40], '#eab308',
                  '#16a34a'
                ],
                'fill-opacity': 1
              }
            });

            // Border layer ‚Äî black like Tax Calculator
            map.addLayer({
              id: 'la-border',
              type: 'line',
              source: 'la-boundaries',
              paint: {
                'line-color': '#000000',
                'line-width': 1
              }
            });

            let hoveredId = null;

            map.on('mousemove', 'la-fill', (e) => {
              map.getCanvas().style.cursor = 'pointer';
              if (e.features.length > 0) {
                if (hoveredId !== null) {
                  map.setFeatureState({ source: 'la-boundaries', id: hoveredId }, { hover: false });
                }
                hoveredId = e.features[0].id;
                map.setFeatureState({ source: 'la-boundaries', id: hoveredId }, { hover: true });
              }
            });

            map.on('mouseleave', 'la-fill', () => {
              map.getCanvas().style.cursor = '';
              if (hoveredId !== null) {
                map.setFeatureState({ source: 'la-boundaries', id: hoveredId }, { hover: false });
                hoveredId = null;
              }
            });

            // Popup on click
            map.on('click', 'la-fill', (e) => {
              if (!e.features.length) return;
              const props = e.features[0].properties;
              let content = `<div class="map-popup">
                <h4>${props.LAD24NM}</h4>`;

              if (props.hasData === true || props.hasData === 'true') {
                content += `<div class="stats">
                  <div><strong>Total Cases:</strong> ${formatNumber(props.totalCases)}</div>
                  <div><strong>% FPNs to Incidents:</strong> ${parseFloat(props.fpnToIncidents).toFixed(1)}%</div>
                </div>`;
              } else {
                content += `<div class="stats"><div style="color:#6b7280;">No data available yet</div></div>`;
              }
              content += '</div>';

              new maplibregl.Popup({ maxWidth: '300px' })
                .setLngLat(e.lngLat)
                .setHTML(content)
                .addTo(map);
            });
          })
          .catch(err => {
            console.error('Failed to load GeoJSON:', err);
            document.getElementById('map').innerHTML = '<div class="map-placeholder">Failed to load map data</div>';
          });
      });
    }

    // ‚îÄ‚îÄ Init ‚îÄ‚îÄ
    function initDashboard() {
      renderTable();
      updateStats();
      // Re-color map if it's already loaded
      if (map && map.getSource('la-boundaries')) {
        updateMapColors();
      }
    }

    function updateMapColors() {
      if (!map || !map.getSource('la-boundaries')) return;
      const source = map.getSource('la-boundaries');
      // Re-fetch and re-color
      fetch('england-la.geojson')
        .then(r => r.json())
        .then(geojson => {
          const dataMap = {};
          ALL_DATA.forEach(d => { dataMap[d.code] = d; });
          geojson.features.forEach(f => {
            const code = f.properties.LAD24CD;
            const d = dataMap[code];
            if (d) {
              f.properties.totalCases = d.totalCases;
              f.properties.fpnToIncidents = d.fpnToIncidents;
              f.properties.solveRate = d.fpnToIncidents;
              f.properties.hasData = true;
            } else {
              f.properties.hasData = false;
              f.properties.solveRate = -1;
            }
          });
          source.setData(geojson);
        });
    }

    // Load data on page ready
    document.addEventListener('DOMContentLoaded', () => {
      initMap();
      // If inline data exists, render immediately; otherwise try spreadsheet
      if (ALL_DATA.length > 0) {
        initDashboard();
      } else {
        loadSpreadsheetData();
        if (!SPREADSHEET_CSV_URL) {
          renderTable();
        }
      }
    });
  </script>

  <!-- Signup Success Modal -->
  <div class="signup-modal-overlay" id="signup-modal" onclick="if(event.target===this)this.classList.remove('show')">
    <div class="signup-modal">
      <button class="signup-modal-x" onclick="document.getElementById('signup-modal').classList.remove('show')" aria-label="Close">&times;</button>
      <h3>Thanks for signing up!</h3>
      <p>Follow us on social media to stay in the loop.</p>
      <div class="signup-modal-socials">
        <a href="https://x.com/lfg_uk" target="_blank" rel="noopener noreferrer" class="btn-x">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          @lfg_uk
        </a>
        <a href="https://www.instagram.com/lookingforgrowthuk/" target="_blank" rel="noopener noreferrer" class="btn-ig">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
          Instagram
        </a>
      </div>
      <a href="https://lookingforgrowth.uk/donate?_gl=1*lzh2sr*_ga*MTc3MTk0NDY4OC4xNzcxOTU1ODU4*_ga_7TVCX31D4P*czE3NzE5NzExMzMkbzMkZzEkdDE3NzE5NzM1OTAkajEyJGwwJGgw" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.75rem 1.25rem;font-weight:700;font-size:.95rem;text-decoration:none;color:#fff;border:2px solid #000;background:#FE5500;margin-bottom:1.5rem;transition:opacity .2s;">Donate</a>
      <button class="signup-modal-close" onclick="document.getElementById('signup-modal').classList.remove('show')">Close</button>
    </div>
  </div>

  <!-- Cookie Banner -->
  <div id="cookie-banner" style="display: none; background-color: #FE5500; z-index: 9999; position: fixed; bottom: 0; left: 0; right: 0; padding: 1rem; border-top: 2px solid black; color: white; font-family: 'DM Sans', sans-serif;">
    <div style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center; justify-content: space-between; max-width: 1400px; margin: 0 auto;">
      <div>
        We use cookies to improve your experience on our site. By using our site, you agree to our
        <a href="https://lfg-site-content.s3.eu-west-2.amazonaws.com/Privacy+Policy.pdf" style="color: #2563eb; text-decoration: underline;">Cookie Policy</a>.
      </div>
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <button onclick="handleCookieAccept()" style="background-color: #4A7C59; border-top: 2px solid black; border-bottom: 6px solid black; border-left: 2px solid black; border-right: 6px solid black; color: white; border-radius: 0.5rem; padding: 0.625rem 1.5rem; cursor: pointer; font-family: 'DM Sans', sans-serif; font-weight: 600;">Accept</button>
        <button onclick="handleCookieDecline()" style="background-color: #EF4444; border-top: 2px solid black; border-bottom: 6px solid black; border-left: 2px solid black; border-right: 6px solid black; color: white; border-radius: 0.5rem; padding: 0.625rem 1.5rem; cursor: pointer; font-family: 'DM Sans', sans-serif; font-weight: 600;">Decline</button>
      </div>
    </div>
  </div>

  <script>
    const cookieConsent = document.cookie.split('; ').find(r => r.startsWith('cookie-consent='));
    if (!cookieConsent) document.getElementById('cookie-banner').style.display = 'flex';

    if (cookieConsent === 'cookie-consent=true') loadGA();

    function loadGA() {
      const script = document.createElement('script');
      script.src = 'https://www.googletagmanager.com/gtag/js?id=G-7TVCX31D4P';
      script.async = true;
      document.head.appendChild(script);
      script.onload = function() {
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-7TVCX31D4P');
      };
    }

    function handleCookieAccept() {
      document.cookie = 'cookie-consent=true; max-age=31536000; path=/';
      document.getElementById('cookie-banner').style.display = 'none';
      window.dispatchEvent(new CustomEvent('cookieConsentChanged', { detail: { consent: true } }));
      loadGA();
    }

    function handleCookieDecline() {
      document.cookie = 'cookie-consent=false; max-age=31536000; path=/';
      document.getElementById('cookie-banner').style.display = 'none';
      window.dispatchEvent(new CustomEvent('cookieConsentChanged', { detail: { consent: false } }));
    }
  </script>

</body>
</html>
